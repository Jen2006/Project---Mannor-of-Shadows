{% extends "base.html" %}

{% block content %}
<style>
body::before {
    background: url('/static/images/laboratory.png') center/cover no-repeat !important;
}
</style>

<div class="room laboratory">
    <div class="room-description">
        <h2>üß™ The Chemistry Laboratory</h2>
        <p>You enter Blackwood's alchemical workshop. Ancient scrolls reveal that chemical reactions follow precise mathematical patterns.</p>
        <p class="lab-note"><strong>üìú Alchemist's Note:</strong> "The universe speaks in patterns. Decode the sequence to unlock the next reaction."</p>
    </div>
    
    <div class="puzzle-area">
        <form method="POST" id="patternForm">
            <div class="pattern-puzzle">
                <!-- Enhanced Puzzle Header -->
                <div class="puzzle-header">
                    <div class="header-title">
                        <span class="header-icon">üî¨</span>
                        <h3>Chemical Sequence Analysis</h3>
                    </div>
                    <div class="difficulty-meter">
                        <span class="difficulty-label">Pattern Complexity:</span>
                        <div class="difficulty-stars">
                            <span class="star">‚≠ê</span>
                            <span class="star">‚≠ê</span>
                            <span class="star">‚≠ê</span>
                            <span class="star">‚òÜ</span>
                            <span class="star">‚òÜ</span>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Sequence Display -->
                <div class="sequence-container">
                    <div class="sequence-header">
                        <h4>üßÆ Reaction Sequence</h4>
                        <p class="sequence-subtitle">Observe the pattern and predict the next value</p>
                    </div>
                    
                    <div class="sequence-display-enhanced">
                        {% for num in pattern.sequence %}
                            {% if num == '?' %}
                            <div class="sequence-item missing">
                                <div class="item-label">Next</div>
                                <div class="number missing-value">?</div>
                                <div class="item-hint">Your Answer</div>
                            </div>
                            {% else %}
                            <div class="sequence-item">
                                <div class="item-label">Step {{ loop.index }}</div>
                                <div class="number">{{ num }}</div>
                                <div class="item-hint">
                                    {% if loop.index > 1 %}
                                        {% set prev_num = pattern.sequence[loop.index-2] %}
                                        {% if prev_num != '?' %}
                                            +{{ num - prev_num }}
                                        {% endif %}
                                    {% else %}
                                        Start
                                    {% endif %}
                                </div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>

                <!-- Enhanced Pattern Analysis -->
                <div class="analysis-section">
                    <div class="analysis-header">
                        <h4>üìä Pattern Analysis</h4>
                        <p class="analysis-subtitle">Use these tools to identify the mathematical relationship</p>
                    </div>
                    
                    <div class="analysis-tools">
                        <div class="analysis-tool" data-tool="difference">
                            <div class="tool-icon">‚ûñ</div>
                            <div class="tool-content">
                                <h5>Difference Analysis</h5>
                                <p>Check the arithmetic progression between numbers</p>
                            </div>
                            <div class="tool-action">
                                <span class="action-text">Analyze</span>
                            </div>
                        </div>
                        
                        <div class="analysis-tool" data-tool="ratio">
                            <div class="tool-icon">‚ûó</div>
                            <div class="tool-content">
                                <h5>Ratio Analysis</h5>
                                <p>Examine multiplicative relationships</p>
                            </div>
                            <div class="tool-action">
                                <span class="action-text">Analyze</span>
                            </div>
                        </div>
                        
                        <div class="analysis-tool" data-tool="fibonacci">
                            <div class="tool-icon">üî¢</div>
                            <div class="tool-content">
                                <h5>Sequence Types</h5>
                                <p>Check for Fibonacci or other special sequences</p>
                            </div>
                            <div class="tool-action">
                                <span class="action-text">Analyze</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Pattern Hint -->
                <div class="pattern-hint-enhanced">
                    <div class="hint-header">
                        <span class="hint-icon">üí°</span>
                        <h4>Pattern Recognition Hint</h4>
                    </div>
                    <div class="hint-content">
                        <p>{{ pattern.hint }}</p>
                        <div class="hint-examples">
                            <span class="example-label">Common Patterns:</span>
                            <div class="example-item">Arithmetic: 2, 4, 6, 8...</div>
                            <div class="example-item">Geometric: 3, 9, 27, 81...</div>
                            <div class="example-item">Fibonacci: 1, 1, 2, 3, 5...</div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Answer Input -->
                <div class="answer-section">
                    <div class="answer-header">
                        <h4>üéØ Your Prediction</h4>
                        <p class="answer-subtitle">Enter the next number in the sequence</p>
                    </div>
                    
                    <div class="answer-input-container">
                        <div class="input-group">
                            <label for="pattern_answer" class="input-label">
                                <span class="label-icon">üî¢</span>
                                Next Number
                            </label>
                            <input type="number" 
                                   id="pattern_answer" 
                                   name="pattern_answer" 
                                   placeholder="Enter the predicted value..."
                                   class="answer-input"
                                   required>
                            <div class="input-feedback">
                                <span class="feedback-icon">üéØ</span>
                                <span class="feedback-text">Analyze the pattern carefully</span>
                            </div>
                        </div>
                        
                        <div class="prediction-confidence">
                            <div class="confidence-header">
                                <span>Prediction Confidence</span>
                                <span class="confidence-value">0%</span>
                            </div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="puzzle-interface">
                <button type="submit" class="btn-primary solve-btn">
                    <span class="btn-icon">üß™</span>
                    Test Prediction
                    <span class="btn-icon">‚öóÔ∏è</span>
                </button>
                <div class="interface-tip">
                    <span class="tip-icon">üîç</span>
                    Look for consistent mathematical relationships
                </div>
            </div>
        </form>
        
        {% if error %}
        <div class="error-message">
            <span class="error-icon">‚ùå</span>
            <div class="error-content">
                <strong>Pattern Mismatch!</strong>
                <p>{{ error }}</p>
            </div>
            <div class="retry-hint">
                <span class="retry-icon">üîÑ</span>
                <span>Re-examine the sequence relationships</span>
            </div>
        </div>
        {% endif %}
    </div>
    
    <div class="hint-section">
        <div class="hint-header">
            <span class="hint-main-icon">üî¨</span>
            <h4>Pattern Solving Strategy</h4>
        </div>
        <div class="hint-content">
            <div class="strategy-points">
                <div class="strategy-item">
                    <span class="strategy-icon">‚ûñ</span>
                    <div class="strategy-text">
                        <strong>Check Differences:</strong> Calculate the difference between consecutive numbers
                    </div>
                </div>
                <div class="strategy-item">
                    <span class="strategy-icon">‚ûó</span>
                    <div class="strategy-text">
                        <strong>Check Ratios:</strong> See if numbers multiply by a consistent factor
                    </div>
                </div>
                <div class="strategy-item">
                    <span class="strategy-icon">üî¢</span>
                    <div class="strategy-text">
                        <strong>Special Sequences:</strong> Look for Fibonacci, square numbers, or other patterns
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const answerInput = document.getElementById('pattern_answer');
    const analysisTools = document.querySelectorAll('.analysis-tool');
    const sequenceItems = document.querySelectorAll('.sequence-item');
    const confidenceFill = document.querySelector('.confidence-fill');
    const confidenceValue = document.querySelector('.confidence-value');
    const feedbackText = document.querySelector('.feedback-text');
    const feedbackIcon = document.querySelector('.feedback-icon');
    
    let currentPattern = null;
    let userConfidence = 0;

    // Initialize pattern analysis
    analyzePattern();

    // Enhanced input interactions
    if (answerInput) {
        answerInput.addEventListener('input', function() {
            const userAnswer = parseInt(this.value);
            
            if (!isNaN(userAnswer)) {
                checkPatternPrediction(userAnswer);
                updateConfidence(userAnswer);
            } else {
                resetFeedback();
            }
        });
        
        // Enhanced focus effects
        answerInput.addEventListener('focus', function() {
            this.parentElement.classList.add('input-focused');
        });
        
        answerInput.addEventListener('blur', function() {
            this.parentElement.classList.remove('input-focused');
        });
    }

    // Interactive analysis tools
    analysisTools.forEach(tool => {
        tool.addEventListener('click', function() {
            const toolType = this.dataset.tool;
            performAnalysis(toolType);
            this.classList.add('tool-active');
            
            setTimeout(() => {
                this.classList.remove('tool-active');
            }, 1000);
        });
        
        // Enhanced hover effects
        tool.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-3px)';
            this.style.boxShadow = '0 5px 15px rgba(76, 175, 80, 0.3)';
        });
        
        tool.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '';
        });
    });

    // Enhanced sequence item interactions
    sequenceItems.forEach(item => {
        if (!item.classList.contains('missing')) {
            item.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.05)';
                this.style.zIndex = '10';
            });
            
            item.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
                this.style.zIndex = '1';
            });
            
            item.addEventListener('click', function() {
                this.classList.add('item-highlight');
                setTimeout(() => {
                    this.classList.remove('item-highlight');
                }, 1000);
            });
        }
    });

    function analyzePattern() {
        const numbers = Array.from(document.querySelectorAll('.sequence-item:not(.missing) .number'))
            .map(el => parseInt(el.textContent));
        
        currentPattern = {
            numbers: numbers,
            type: 'unknown',
            difference: null,
            ratio: null,
            expectedNext: null
        };
        
        // Analyze arithmetic pattern
        if (numbers.length >= 3) {
            const differences = [];
            for (let i = 1; i < numbers.length; i++) {
                differences.push(numbers[i] - numbers[i-1]);
            }
            
            if (differences.every(diff => diff === differences[0])) {
                currentPattern.type = 'arithmetic';
                currentPattern.difference = differences[0];
                currentPattern.expectedNext = numbers[numbers.length - 1] + differences[0];
            }
        }
        
        // Analyze geometric pattern
        if (currentPattern.type === 'unknown' && numbers.length >= 3) {
            const ratios = [];
            for (let i = 1; i < numbers.length; i++) {
                ratios.push(numbers[i] / numbers[i-1]);
            }
            
            if (ratios.every(ratio => Math.abs(ratio - ratios[0]) < 0.001)) {
                currentPattern.type = 'geometric';
                currentPattern.ratio = ratios[0];
                currentPattern.expectedNext = numbers[numbers.length - 1] * ratios[0];
            }
        }
        
        // Analyze Fibonacci-like pattern
        if (currentPattern.type === 'unknown' && numbers.length >= 4) {
            let isFibonacci = true;
            for (let i = 2; i < numbers.length; i++) {
                if (numbers[i] !== numbers[i-2] + numbers[i-1]) {
                    isFibonacci = false;
                    break;
                }
            }
            
            if (isFibonacci) {
                currentPattern.type = 'fibonacci';
                currentPattern.expectedNext = numbers[numbers.length - 2] + numbers[numbers.length - 1];
            }
        }
    }

    function checkPatternPrediction(userAnswer) {
        if (!currentPattern || !currentPattern.expectedNext) return;
        
        const difference = Math.abs(userAnswer - currentPattern.expectedNext);
        const tolerance = Math.max(1, currentPattern.expectedNext * 0.1); // 10% tolerance
        
        if (difference <= tolerance) {
            answerInput.style.borderColor = '#4caf50';
            answerInput.style.background = 'linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))';
            answerInput.style.boxShadow = '0 0 15px rgba(76, 175, 80, 0.3)';
            
            feedbackIcon.textContent = '‚úÖ';
            feedbackText.textContent = 'Great prediction! This matches the pattern.';
            feedbackText.style.color = '#4caf50';
        } else {
            answerInput.style.borderColor = '#ff9800';
            answerInput.style.background = 'linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05))';
            answerInput.style.boxShadow = '0 0 10px rgba(255, 152, 0, 0.2)';
            
            feedbackIcon.textContent = 'üí≠';
            feedbackText.textContent = 'Check the pattern relationships again.';
            feedbackText.style.color = '#ff9800';
        }
    }

    function updateConfidence(userAnswer) {
        if (!currentPattern || !currentPattern.expectedNext) {
            userConfidence = 0;
        } else {
            const difference = Math.abs(userAnswer - currentPattern.expectedNext);
            const maxDifference = Math.max(10, currentPattern.expectedNext * 0.5);
            userConfidence = Math.max(0, 100 - (difference / maxDifference) * 100);
        }
        
        confidenceFill.style.width = `${userConfidence}%`;
        confidenceValue.textContent = `${Math.round(userConfidence)}%`;
        
        // Update confidence bar color
        if (userConfidence >= 80) {
            confidenceFill.style.background = 'linear-gradient(135deg, #4caf50, #45a049)';
        } else if (userConfidence >= 50) {
            confidenceFill.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
        } else {
            confidenceFill.style.background = 'linear-gradient(135deg, #f44336, #d32f2f)';
        }
    }

    function performAnalysis(toolType) {
        // Visual feedback for analysis
        const missingItem = document.querySelector('.sequence-item.missing');
        if (missingItem) {
            missingItem.classList.add('analyzing');
            setTimeout(() => {
                missingItem.classList.remove('analyzing');
            }, 500);
        }
        
        // Could add more sophisticated analysis feedback here
    }

    function resetFeedback() {
        answerInput.style.borderColor = '#666';
        answerInput.style.background = '';
        answerInput.style.boxShadow = 'none';
        
        feedbackIcon.textContent = 'üéØ';
        feedbackText.textContent = 'Analyze the pattern carefully';
        feedbackText.style.color = '#ccc';
        
        confidenceFill.style.width = '0%';
        confidenceValue.textContent = '0%';
    }
});

// Enhanced CSS animations for laboratory
const laboratoryStyles = document.createElement('style');
laboratoryStyles.textContent = `
    @keyframes chemicalReaction {
        0% { transform: scale(1); background: #4caf50; }
        50% { transform: scale(1.1); background: #ffeb3b; }
        100% { transform: scale(1); background: #4caf50; }
    }
    
    @keyframes analyzingPulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }
    
    @keyframes numberPop {
        0% { transform: scale(0.8); opacity: 0; }
        70% { transform: scale(1.1); }
        100% { transform: scale(1); opacity: 1; }
    }
    
    .item-highlight {
        animation: chemicalReaction 1s ease-in-out;
    }
    
    .tool-active {
        animation: chemicalReaction 0.5s ease-in-out;
    }
    
    .analyzing {
        animation: analyzingPulse 0.5s ease-in-out infinite;
    }
    
    .sequence-item .number {
        animation: numberPop 0.5s ease-out;
    }
`;
document.head.appendChild(laboratoryStyles);
</script>

<style>
/* Enhanced Room Description */
.room.laboratory .room-description h2 {
    background: linear-gradient(135deg, #4caf50, #8bc34a);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-size: 2.2rem;
    margin-bottom: 1rem;
}

.lab-note {
    background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(139, 195, 74, 0.1));
    border-left: 4px solid #4caf50;
    padding: 1rem;
    border-radius: 8px;
    font-style: italic;
}

/* Enhanced Puzzle Header */
.puzzle-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
    padding: 1.5rem;
    border-radius: 15px;
    border: 2px solid rgba(76, 175, 80, 0.3);
    margin: 2rem 0;
    backdrop-filter: blur(10px);
}

.header-title {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.header-icon {
    font-size: 2.5rem;
    animation: chemicalReaction 3s infinite;
}

.header-title h3 {
    color: #4caf50;
    font-size: 1.8rem;
    margin: 0;
}

.difficulty-meter {
    text-align: right;
}

.difficulty-label {
    display: block;
    color: #ccc;
    font-size: 0.9rem;
    margin-bottom: 0.3rem;
}

.difficulty-stars {
    display: flex;
    gap: 0.2rem;
}

.star {
    font-size: 1.2rem;
}

/* Enhanced Sequence Container */
.sequence-container {
    margin: 2.5rem 0;
}

.sequence-header {
    text-align: center;
    margin-bottom: 1.5rem;
}

.sequence-header h4 {
    color: #4caf50;
    font-size: 1.4rem;
    margin-bottom: 0.5rem;
}

.sequence-subtitle {
    color: #ccc;
    font-size: 0.9rem;
}

.sequence-display-enhanced {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    margin: 2rem 0;
    flex-wrap: wrap;
}

.sequence-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.8rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.04));
    border-radius: 15px;
    border: 2px solid rgba(76, 175, 80, 0.3);
    transition: all 0.3s ease;
    min-width: 100px;
    position: relative;
}

.sequence-item.missing {
    border: 2px dashed rgba(255, 215, 0, 0.5);
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
}

.item-label {
    color: #ffd700;
    font-size: 0.8rem;
    font-weight: bold;
    text-transform: uppercase;
}

.number {
    font-size: 2rem;
    font-weight: bold;
    color: white;
    background: linear-gradient(135deg, #4caf50, #8bc34a);
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    border: 2px solid #ffd700;
}

.missing-value {
    background: linear-gradient(135deg, #ff9800, #ff5722);
    font-size: 1.8rem;
}

.item-hint {
    color: #ccc;
    font-size: 0.7rem;
    text-align: center;
    min-height: 1rem;
}

/* Enhanced Analysis Section */
.analysis-section {
    margin: 2.5rem 0;
}

.analysis-header {
    text-align: center;
    margin-bottom: 1.5rem;
}

.analysis-header h4 {
    color: #4caf50;
    font-size: 1.4rem;
    margin-bottom: 0.5rem;
}

.analysis-subtitle {
    color: #ccc;
    font-size: 0.9rem;
}

.analysis-tools {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.2rem;
    margin-top: 1rem;
}

.analysis-tool {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.2rem;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.04));
    border-radius: 12px;
    border: 2px solid rgba(76, 175, 80, 0.3);
    transition: all 0.3s ease;
    cursor: pointer;
}

.analysis-tool:hover {
    background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05));
}

.tool-icon {
    font-size: 2rem;
    flex-shrink: 0;
}

.tool-content {
    flex: 1;
}

.tool-content h5 {
    color: #ffd700;
    font-size: 1rem;
    margin-bottom: 0.3rem;
}

.tool-content p {
    color: #ccc;
    font-size: 0.8rem;
    margin: 0;
}

.tool-action {
    padding: 0.5rem 1rem;
    background: rgba(76, 175, 80, 0.2);
    border-radius: 20px;
    border: 1px solid rgba(76, 175, 80, 0.5);
}

.action-text {
    color: #4caf50;
    font-size: 0.8rem;
    font-weight: bold;
}

/* Enhanced Pattern Hint */
.pattern-hint-enhanced {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
    padding: 1.5rem;
    border-radius: 12px;
    border-left: 4px solid #ffd700;
    margin: 2rem 0;
}

.hint-header {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    margin-bottom: 1rem;
}

.hint-icon {
    font-size: 1.8rem;
}

.hint-header h4 {
    color: #ffd700;
    margin: 0;
}

.hint-content p {
    margin-bottom: 1rem;
    line-height: 1.5;
}

.hint-examples {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.example-label {
    color: #ffd700;
    font-weight: bold;
    font-size: 0.9rem;
}

.example-item {
    color: #ccc;
    font-size: 0.85rem;
    padding-left: 1rem;
}

/* Enhanced Answer Section */
.answer-section {
    margin: 2.5rem 0;
}

.answer-header {
    text-align: center;
    margin-bottom: 1.5rem;
}

.answer-header h4 {
    color: #4caf50;
    font-size: 1.4rem;
    margin-bottom: 0.5rem;
}

.answer-subtitle {
    color: #ccc;
    font-size: 0.9rem;
}

.answer-input-container {
    max-width: 400px;
    margin: 0 auto;
}

.input-group {
    margin-bottom: 1.5rem;
}

.input-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #ffd700;
    font-weight: bold;
    margin-bottom: 0.8rem;
    font-size: 1.1rem;
}

.label-icon {
    font-size: 1.2rem;
}

.answer-input {
    width: 100%;
    padding: 15px 20px;
    font-size: 1.2rem;
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    background: rgba(42, 42, 42, 0.9);
    color: #f5f5f5;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.answer-input:focus {
    outline: none;
    border-color: #4caf50;
    box-shadow: 0 0 20px rgba(76, 175, 80, 0.4);
    background: rgba(42, 42, 42, 0.95);
}

.input-group.input-focused .input-label {
    color: #4caf50;
}

.input-feedback {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.8rem;
    padding: 0.8rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border: 1px dashed rgba(255, 255, 255, 0.2);
}

.prediction-confidence {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
    padding: 1rem;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.confidence-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    color: #ccc;
}

.confidence-value {
    font-weight: bold;
}

.confidence-bar {
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.confidence-fill {
    height: 100%;
    background: linear-gradient(135deg, #f44336, #d32f2f);
    border-radius: 4px;
    transition: all 0.3s ease;
}

/* Enhanced Buttons and Interface */
.solve-btn {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding: 15px 35px;
    font-size: 1.3rem;
    background: linear-gradient(135deg, #4caf50, #45a049);
    border: none;
    border-radius: 50px;
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
    transition: all 0.3s ease;
}

.solve-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(76, 175, 80, 0.6);
    background: linear-gradient(135deg, #45a049, #4caf50);
}

.interface-tip {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 0.8rem;
    color: #ccc;
    font-size: 0.9rem;
    font-style: italic;
}

/* Enhanced Error Messages */
.error-message {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, rgba(244, 67, 54, 0.1), rgba(244, 67, 54, 0.05));
    border-radius: 12px;
    border-left: 4px solid #f44336;
    margin-top: 1.5rem;
    animation: bounceIn 0.5s ease-out;
}

.error-message .error-content {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.error-icon {
    font-size: 2rem;
    flex-shrink: 0;
}

.retry-hint {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.8rem;
    background: rgba(255, 152, 0, 0.2);
    border-radius: 8px;
    border-left: 3px solid #ff9800;
}

.retry-icon {
    font-size: 1.2rem;
}

/* Enhanced Hint Section */
.hint-section {
    background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(139, 195, 74, 0.05));
    padding: 1.5rem;
    border-radius: 12px;
    border-left: 4px solid #4caf50;
    margin-top: 1.5rem;
}

.strategy-points {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.strategy-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.strategy-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
    margin-top: 0.2rem;
}

.strategy-text {
    flex: 1;
}

.strategy-text strong {
    color: #4caf50;
}

/* Responsive Design */
@media (max-width: 768px) {
    .puzzle-header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }
    
    .sequence-display-enhanced {
        gap: 1rem;
    }
    
    .sequence-item {
        min-width: 80px;
        padding: 1rem;
    }
    
    .number {
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
    }
    
    .analysis-tools {
        grid-template-columns: 1fr;
    }
    
    .solve-btn {
        width: 100%;
        justify-content: center;
    }
    
    .strategy-item {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
    }
}
</style>
{% endblock %}